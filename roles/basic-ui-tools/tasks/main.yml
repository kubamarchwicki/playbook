- name: Install ui-stuff tools
  become: yes
  apt:
    state: latest
    name:
    - firefox
    - chromium-browser

- name: Install simplenote
  block: 
  - name: Verify if simplenote Is Installed
    stat:
      path: "/usr/bin/simplenote"
    register: "simplenote_installed"
  - name: Get the latest version of simplenote
    shell: curl -s https://api.github.com/repos/Automattic/simplenote-electron/releases/latest | grep 'name' | cut -d\" -f4
    args:
      warn: False
    register: latest_simplenote_version
    changed_when: false
  - name: Install simplenote
    apt:
      deb: https://github.com/Automattic/simplenote-electron/releases/download/v{{ latest_simplenote_version.stdout }}/Simplenote-linux-{{ latest_simplenote_version.stdout }}-amd64.deb
    become: yes
    when: not simplenote_installed.stat.exists

- name: Install dropbox
  block:
  - name: Verify dropbox is installed
    stat:
      path: "~/.dropbox-dist/dropboxd"
    register: "dropbox_installed"  
  - name: Install dropbox package
    shell: cd ~ && wget -O - "https://www.dropbox.com/download?plat=lnx.x86_64" | tar xzf -
    args:
      warn: False    
    when: not dropbox_installed.stat.exists

- name: Install slack
  block: 
  - name: Verify if slack Is Installed
    stat:
      path: "/usr/bin/slack"
    register: "slack_installed"
  
  - name: Install slack package
    apt:
      deb: https://downloads.slack-edge.com/linux_releases/slack-desktop-4.12.2-amd64.deb
    become: yes
    when: not slack_installed.stat.exists

- name: Install Inconsolata font
  block:
  - name: Get the latest version of Inconsolata font
    shell: curl -s https://api.github.com/repos/googlefonts/Inconsolata/releases/latest | grep 'tag_name' | cut -d\" -f4
    args:
      warn: False
    register: latest_inconsolata_version
    changed_when: false
  - name: create ~/.fonts/Inconsolata directory
    file:
      path: ~/.fonts/Inconsolata
      state: directory    
  - name: Copy Inconsolata font
    unarchive:
      src: https://github.com/googlefonts/Inconsolata/releases/download/{{ latest_inconsolata_version.stdout }}/fonts_ttf.zip
      dest: ~/.fonts/Inconsolata      
      remote_src: yes

  - name: Install Firacode font
    block:
    - name: Create ~/.fonts/FiraCode directory
      file:
        path: ~/.fonts/FiraCode
        state: directory    
    - name: Create a temporary directory 
      tempfile:
        state: directory
      changed_when: False
      register: font_dowload_tempdir
    - name: Get the latest version of FiraCode font
      shell: curl -s https://api.github.com/repos/tonsky/FiraCode/releases/latest | grep 'tag_name' | cut -d\" -f4
      args:
        warn: False
      register: latest_firacode_version 
      changed_when: false
    - name: Dowload the FiraCode font archive to the temporary directory
      get_url:
        url: https://github.com/tonsky/FiraCode/releases/download/{{ latest_firacode_version.stdout }}/Fira_Code_v{{ latest_firacode_version.stdout }}.zip
        dest: '{{ font_dowload_tempdir.path }}/firacode.zip'
      changed_when: False
    - name: Install FiraCode
      shell: 'unzip -jo "{{ font_dowload_tempdir.path }}/firacode.zip" ttf/* -d ~/.fonts/FiraCode'
      args:
        warn: no
    always:
      - name: Clean up the firecode temporary download directory
        file:
          path: '{{ font_dowload_tempdir.path }}'
          state: absent
        changed_when: False

- name: Install fonts
  shell: fc-cache -fv
